(this.webpackJsonpglobetravel=this.webpackJsonpglobetravel||[]).push([[0],{121:function(e,t,n){},153:function(e,t,n){"use strict";n.r(t);var r=n(7),c=n(73),s=n.n(c),a=(n(121),n(12)),o=n(11),i=function(e,t){var n=Object(r.useState)((function(){try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(r){return console.log(r),t}})),c=Object(o.a)(n,2),s=c[0],a=c[1];return[s,function(t){try{var n=t instanceof Function?t(s):t;a(n),window.localStorage.setItem(e,JSON.stringify(n))}catch(r){console.log(r)}}]},l=n(23),u=n(157),j=n(6),d=80,b=function(e,t,n){var r=4*n.width,c=parseInt((e+180)/360*n.width+.5),s=n.height-parseInt((t+90)/180*n.height-.5),a=parseInt(r*(s-1)+4*c)+3;return n.data[a]>90},x=function(e){var t=document.createElement("canvas").getContext("2d");return t.canvas.width=e.width,t.canvas.height=e.height,t.drawImage(e,0,0,e.width,e.height),t.getImageData(0,0,e.width,e.height)},f=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:d,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=(90-e)*Math.PI/180,s=(90-t)*Math.PI/180,a=n*(1+r);return{x:a*Math.sin(c)*Math.cos(s),y:a*Math.cos(c),z:a*Math.sin(c)*Math.sin(s)}},m=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=f(e,t,n,r);return new j.Vector3(c.x,c.y,c.z)},h=(new Date).getTimezoneOffset()||0,g=[0,Math.PI*(h/720),0],O=n(4),v=function(){return Object(O.jsxs)("mesh",{rotation:g,children:[Object(O.jsx)("sphereBufferGeometry",{args:[d,32,32]}),Object(O.jsx)("meshBasicMaterial",{color:"#1F2937"})]})},y=n(14),p=n.n(y),N=n(21),C=function(){var e=Object(r.useState)([]),t=Object(o.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){var e=function(){var e=Object(N.a)(p.a.mark((function e(){var t,n,r,s,a,o,i,l,u,j;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){var n=new Image;n.addEventListener("load",(function(){return e(n)})),n.addEventListener("error",(function(e){return t(e)})),n.src="".concat("/globetravel","/images/map.png")}));case 2:t=e.sent,n=x(t),r=[],s=Math.PI/180,a=200,o=-90;case 8:if(!(o<=90)){e.next=23;break}i=25*Math.cos(Math.abs(o)*s)*Math.PI*2*2,l=0;case 11:if(!(l<i)){e.next=20;break}if(b(u=360*l/i-180,o,n)){e.next=15;break}return e.abrupt("continue",17);case 15:j=f(o,u),r.push(j.x,j.y,j.z);case 17:l++,e.next=11;break;case 20:o+=180/a,e.next=8;break;case 23:c(new Float32Array(r));case 24:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object(O.jsxs)("points",{rotation:g,children:[Object(O.jsx)("bufferGeometry",{attach:"geometry",children:n.length&&Object(O.jsx)("bufferAttribute",{attachObject:["attributes","position"],count:n.length/3,array:n,itemSize:3})}),Object(O.jsx)("pointsMaterial",{size:1.5,color:"#C7D2FE"})]})},w=function(e){var t=e.city,n=t.lat,c=t.lng,s=Object(r.useMemo)((function(){var e=m(n,c,d),t=m(n,c,85);return new j.CatmullRomCurve3([e,t])}),[n,c]),a=Object(r.useMemo)((function(){var e=f(n,c,85);return[e.x,e.y,e.z]}),[n,c]);return Object(O.jsxs)("mesh",{rotation:g,children:[Object(O.jsxs)("mesh",{children:[Object(O.jsx)("tubeBufferGeometry",{args:[s,44,.3,8]}),Object(O.jsx)("meshBasicMaterial",{color:"#FCD34D"})]}),Object(O.jsxs)("mesh",{position:a,children:[Object(O.jsx)("sphereBufferGeometry",{args:[.3,5,5]}),Object(O.jsx)("meshBasicMaterial",{color:"#FCD34D"})]})]})},I=n(42),k={trail:"#10B981",sail:"#3B82F6",bus:"#F472B6"},M=function(e){var t=e.travel,n=Object(r.useMemo)((function(){for(var e=t.start,n=t.end,r=m(e.lat,e.lng,80.3),c=m(n.lat,n.lng,80.3),s=[r],a=Object(I.a)([e.lng,e.lat],[n.lng,n.lat]),o=1;o<6;o++){var i=a(1/7*o);s.push(m(i[1],i[0],80.3))}return s.push(c),new j.CatmullRomCurve3(s)}),[t]);return Object(O.jsxs)("mesh",{rotation:g,children:[Object(O.jsx)("tubeBufferGeometry",{args:[n,44,.3,8]}),Object(O.jsx)("meshBasicMaterial",{color:k[t.type]})]})},S=function(e){var t=e.travel,n=Object(r.useMemo)((function(){var e=t.start,n=t.end,r=m(e.lat,e.lng,d),c=m(n.lat,n.lng,d),s=Object(I.a)([e.lng,e.lat],[n.lng,n.lat]),a=s(.25),o=s(.75),i=.5*r.distanceTo(c)+d,l=m(a[1],a[0],i),u=m(o[1],o[0],i);return new j.CubicBezierCurve3(r,l,u,c)}),[t]);return Object(O.jsxs)("mesh",{rotation:g,children:[Object(O.jsx)("tubeBufferGeometry",{args:[n,44,.3,8]}),Object(O.jsx)("meshBasicMaterial",{color:"#EF4444"})]})},F=function(e){var t=e.cities,n=e.travels;return Object(O.jsxs)(l.a,{orthographic:!0,camera:{position:[0,0,200],zoom:3},children:[Object(O.jsx)(v,{}),Object(O.jsx)(C,{}),t.map((function(e){return Object(O.jsx)(w,{city:e},e.geonameId)})),n.map((function(e){return"flight"===e.type?Object(O.jsx)(S,{travel:e},e.id):Object(O.jsx)(M,{travel:e},e.id)})),Object(O.jsx)(u.a,{enablePan:!0,enableRotate:!0,autoRotate:!0})]})},B=n(9),R=n(78),T=n.n(R),E=n(79),A=n(27),D=n.n(A),G=n(41),z={ENG:"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f",SCT:"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f",WLS:"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f"},P=Object.keys(z),J=function(e){return P.includes(e)?D()(z[e]):D()(Object(G.a)(e))},L=function(e){var t=e.onSelect,n=Object(r.useState)(""),c=Object(o.a)(n,2),s=c[0],a=c[1],i=Object(r.useState)([]),l=Object(o.a)(i,2),u=l[0],j=l[1],d=Object(r.useRef)();return Object(r.useEffect)((function(){return d.current.focus()}),[]),Object(r.useEffect)((function(){var e=function(){var e=Object(N.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,T.a.get("https://secure.geonames.org/search",{params:{username:"lexcast",maxRows:5,q:s,type:"json"}});case 3:t=e.sent,j(t.data.geonames.map((function(e){return"GB"===e.countryCode&&P.includes(e.adminCode1)?Object(B.a)(Object(B.a)({},e),{},{countryCode:e.adminCode1}):e}))),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),j([]),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();s?e():j([])}),[s]),Object(O.jsxs)("div",{className:"flex flex-col justify-center relative",children:[Object(O.jsx)(E.DebounceInput,{inputRef:d,minLength:2,value:s,debounceTimeout:300,placeholder:"Search any place...",className:"flex items-center h-10 px-3 rounded-full bg-gray-800 text-gray-300 focus:outline-none focus:ring",onChange:function(e){return a(e.target.value)}}),Array.isArray(u)&&u.length>0&&Object(O.jsx)("div",{className:"top-10 ring left-0 right-0 absolute mt-4 rounded-lg bg-gray-800 overflow-hidden text-sm",children:u.map((function(e){return Object(O.jsxs)("div",{onClick:function(){t(e),j([]),a(""),d.current.focus()},className:"cursor-pointer px-3 py-2 flex items-center hover:bg-gray-700",children:[e.countryCode&&Object(O.jsx)("span",{className:"mr-2",children:J(e.countryCode)}),Object(O.jsx)("span",{className:"flex-1",children:e.name}),e.adminName1&&Object(O.jsx)("span",{className:"ml-2 text-xs text-gray-400",children:e.adminName1})]},e.geonameId)}))})]})},W=n(16),_=n(15),U={flight:_.d,trail:_.g,sail:_.e,bus:_.b},V=function(e){var t=e.onFinish,n=Object(r.useState)(),c=Object(o.a)(n,2),s=c[0],a=c[1],i=Object(r.useState)(),l=Object(o.a)(i,2),u=l[0],j=l[1];return Object(O.jsxs)("div",{className:"flex flex-col justify-center",children:[!s&&Object(O.jsx)("div",{className:"flex items-center justify-around",children:Object.entries(U).map((function(e){var t=Object(o.a)(e,2),n=t[0],r=t[1];return Object(O.jsx)("div",{onClick:function(){return a(n)},className:"flex items-center justify-center rounded-full h-10 w-10 bg-gray-800 cursor-pointer hover:bg-gray-700",children:Object(O.jsx)(W.a,{icon:r})},n)}))}),!!s&&!u&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{className:"flex items-center mb-2",children:[Object(O.jsx)("div",{className:"text-xs mr-2 flex items-center justify-center rounded-full h-6 w-6 bg-gray-800",children:Object(O.jsx)(W.a,{icon:U[s]})}),"From:"]}),Object(O.jsx)(L,{onSelect:function(e){return j(e)}})]}),!!s&&!!u&&Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{className:"flex items-center mb-2",children:[Object(O.jsx)("div",{className:"mr-2 flex items-center justify-center rounded-full h-6 w-6 bg-gray-800",children:Object(O.jsx)(W.a,{icon:U[s]})}),Object(O.jsxs)("div",{className:"flex items-center mr-2",children:[u.countryCode&&Object(O.jsx)("span",{className:"mr-2",children:D()(Object(G.a)(u.countryCode))}),Object(O.jsx)("span",{children:u.name})]}),"To:"]}),Object(O.jsx)(L,{onSelect:function(e){t(s,u,e),a(),j()}})]})]})},q={flight:_.d,trail:_.g,sail:_.e,bus:_.b},X=function(e){var t=e.travels,n=e.onRemove;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("span",{className:"text-xs font-medium mb-1 mt-2",children:["TRAVELS ",Object(O.jsxs)("span",{className:"text-gray-400",children:["(",t.length,")"]})]}),Object(O.jsx)("div",{className:"text-xs max-h-24 bg-gray-800 rounded-lg overflow-y-auto",children:t.map((function(e){return Object(O.jsxs)("div",{className:"group cursor-pointer px-3 py-2 flex items-center hover:bg-gray-700",children:[Object(O.jsx)(W.a,{className:"text-xs mr-2 text-gray-400",icon:q[e.type]}),Object(O.jsx)("div",{className:"flex-1 flex items-center",children:["start","end"].map((function(t){return Object(O.jsxs)("div",{className:"flex items-center",children:[e[t].countryCode&&Object(O.jsx)("span",{className:"mr-2 flex-shrink-0",children:J(e[t].countryCode)}),Object(O.jsx)("span",{className:"flex-1",children:e[t].name}),"start"===t&&Object(O.jsx)(W.a,{className:"text-xs mx-2 text-gray-500",icon:_.a})]},t)}))}),Object(O.jsx)("span",{onClick:function(){return n(e)},className:"group-hover:visible invisible text-xs",children:Object(O.jsx)(W.a,{icon:_.f})})]},e.id)}))})]})},$=function(e){var t=e.cities,n=e.onRemove;return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("span",{className:"text-xs font-medium mb-1 mt-2",children:["CITIES ",Object(O.jsxs)("span",{className:"text-gray-400",children:["(",t.length,")"]})]}),Object(O.jsx)("div",{className:"text-xs max-h-24 bg-gray-800 rounded-lg overflow-y-auto",children:t.map((function(e){return Object(O.jsxs)("div",{className:"group px-3 py-2 flex items-center hover:bg-gray-700",children:[e.countryCode&&Object(O.jsx)("span",{className:"mr-2 flex-shrink-0",children:J(e.countryCode)}),Object(O.jsx)("span",{className:"flex-1",children:e.name}),Object(O.jsx)("span",{onClick:function(){return n(e)},className:"cursor-pointer group-hover:visible invisible text-xs",children:Object(O.jsx)(W.a,{icon:_.f})})]},e.geonameId)}))})]})},H=function(e){var t=e.countries;return Object(O.jsx)("div",{className:"flex flex-wrap mb-6",children:t.map((function(e){return Object(O.jsx)("div",{children:J(e)},e)}))})},K=function(e){var t=e.cities,n=e.travels,r=e.countries;return Object(O.jsx)("a",{title:"Export",className:"flex items-center justify-center focus:outline-none focus:ring w-8 h-8 rounded bg-gray-800 hover:bg-gray-700",href:"data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify({cities:t,travels:n,countries:r},null,2))),download:"globetravel.json",children:Object(O.jsx)(W.a,{icon:_.c})})},Q=function(e){var t=e.setCities,n=e.setTravels,r=e.setCountries;return Object(O.jsxs)("label",{title:"Import",className:"cursor-pointer flex items-center justify-center focus:outline-none focus:ring w-8 h-8 rounded bg-gray-800 hover:bg-gray-700",children:[Object(O.jsx)("input",{className:"hidden",type:"file",accept:"application/JSON",onChange:function(e){var c=new FileReader;c.readAsText(e.target.files[0],"UTF-8"),c.onload=function(e){var c=JSON.parse(e.target.result);t(c.cities),n(c.travels),r(c.countries)}}}),Object(O.jsx)(W.a,{icon:_.i})]})},Y=function(e){var t=e.setCities,n=e.setTravels,r=e.setCountries;return Object(O.jsx)("button",{onClick:function(){window.confirm("Do you really want to delete everything?")&&(t([]),n([]),r([]))},title:"Reset",className:"flex items-center justify-center focus:outline-none focus:ring w-8 h-8 rounded bg-gray-800 hover:bg-gray-700",children:Object(O.jsx)(W.a,{icon:_.h})})},Z=function(){return Object(O.jsxs)(O.Fragment,{children:[Object(O.jsxs)("div",{className:"justify-end flex items-center mt-4 mb-1 text-gray-400 text-xs",children:["Made by",Object(O.jsx)("span",{className:"mx-1",children:J("MX")}),Object(O.jsx)("a",{target:"_blank",rel:"noopener noreferrer",className:"text-blue-400",href:"https://github.com/lexcast",children:"Daniel Alejandro Cast"})]}),Object(O.jsxs)("div",{className:"text-right text-gray-400 text-xs",children:["Globetravel uses"," ",Object(O.jsx)("a",{target:"_blank",rel:"noopener noreferrer",className:"text-blue-400",href:"https://www.geonames.org/",children:"Geonames API"})]})]})},ee=n(44),te=n.n(ee),ne=["geonameId","name","countryCode","adminName1","lat","lng"],re=function(){var e=Object(r.useState)(),t=Object(o.a)(e,2),n=t[0],c=t[1],s=i("@globetravel.cities",[]),l=Object(o.a)(s,2),u=l[0],j=l[1],d=i("@globetravel.travels",[]),b=Object(o.a)(d,2),x=b[0],f=b[1],m=i("@globetravel.countries",[]),h=Object(o.a)(m,2),g=h[0],v=h[1],y=function(e,t,n){return t.some((function(t){return t.countryCode===e}))||n.some((function(t){return t.start.countryCode===e||t.end.countryCode===e}))};return Object(O.jsxs)("div",{className:"text-gray-300 w-screen h-screen bg-gray-900 flex overflow-hidden flex-no-wrap",children:[Object(O.jsx)("div",{className:"h-screen w-2/3 bg-gray-900",children:Object(O.jsx)(F,{cities:u,travels:x})}),Object(O.jsxs)("div",{className:"flex-1 flex flex-col flex-nowrap px-10 pt-14 pb-4 h-screen overflow-y-auto",children:[g.length>0&&Object(O.jsx)(H,{countries:g}),Object(O.jsxs)("div",{className:"flex-1",children:[Object(O.jsxs)("div",{className:"flex justify-around mb-8",children:[Object(O.jsx)("button",{onClick:function(){return c("city"===n?null:"city")},className:"focus:outline-none focus:ring rounded-full bg-gray-800 h-8 px-4 flex items-center text-gray-300 hover:bg-gray-700 font-bolt",children:"Add City"}),Object(O.jsx)("button",{onClick:function(){return c("travel"===n?null:"travel")},className:"focus:outline-none focus:ring rounded-full bg-gray-800 h-8 px-4 flex items-center text-gray-300 hover:bg-gray-700 font-bolt",children:"Add Travel"})]}),"city"===n&&Object(O.jsx)(L,{onSelect:function(e){var t=te()(e,ne);j([].concat(Object(a.a)(u),[t])),g.includes(t.countryCode)||v([].concat(Object(a.a)(g),[t.countryCode]))}}),"travel"===n&&Object(O.jsx)(V,{onFinish:function(e,t,n){var r=te()(t,ne),c=te()(n,ne),s=t.geonameId+"_"+n.geonameId;f([].concat(Object(a.a)(x),[{type:e,start:r,end:c,id:s}])),g.includes(t.countryCode)||v((function(e){return[].concat(Object(a.a)(e),[t.countryCode])})),g.includes(n.countryCode)||v((function(e){return[].concat(Object(a.a)(e),[n.countryCode])}))}})]}),u.length>0&&Object(O.jsx)($,{cities:u,onRemove:function(e){var t=e.geonameId,n=e.countryCode,r=u.filter((function(e){return t!==e.geonameId}));j(r),y(n,r,x)||v(g.filter((function(e){return e!==n})))}}),x.length>0&&Object(O.jsx)(X,{travels:x,onRemove:function(e){var t=e.id,n=e.start,r=e.end,c=x.filter((function(e){return t!==e.id}));f(c),y(n.countryCode,u,c)||v((function(e){return e.filter((function(e){return e!==n.countryCode}))})),y(r.countryCode,u,c)||v((function(e){return e.filter((function(e){return e!==r.countryCode}))}))}}),Object(O.jsxs)("div",{className:"mt-6 flex items-center justify-end gap-4",children:[Object(O.jsx)(Y,{setCities:j,setTravels:f,setCountries:v}),Object(O.jsx)(Q,{setCities:j,setTravels:f,setCountries:v}),Object(O.jsx)(K,{cities:u,travels:x,countries:g})]}),Object(O.jsx)(Z,{})]})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(O.jsx)(re,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[153,1,2]]]);
//# sourceMappingURL=main.4c0a4efa.chunk.js.map