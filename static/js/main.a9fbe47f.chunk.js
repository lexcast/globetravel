(this.webpackJsonpglobetravel=this.webpackJsonpglobetravel||[]).push([[0],{121:function(e,t,n){},153:function(e,t,n){"use strict";n.r(t);var r=n(6),c=n(72),s=n.n(c),a=(n(121),n(11)),i=function(e,t){var n=Object(r.useState)((function(){try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(r){return console.log(r),t}})),c=Object(a.a)(n,2),s=c[0],i=c[1];return[s,function(t){try{var n=t instanceof Function?t(s):t;i(n),window.localStorage.setItem(e,JSON.stringify(n))}catch(r){console.log(r)}}]},o=n(23),l=n(157),u=n(7),j=80,d=function(e,t,n){var r=4*n.width,c=parseInt((e+180)/360*n.width+.5),s=n.height-parseInt((t+90)/180*n.height-.5),a=parseInt(r*(s-1)+4*c)+3;return n.data[a]>90},b=function(e){var t=document.createElement("canvas").getContext("2d");return t.canvas.width=e.width,t.canvas.height=e.height,t.drawImage(e,0,0,e.width,e.height),t.getImageData(0,0,e.width,e.height)},f=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:j,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=(90-e)*Math.PI/180,s=(90-t)*Math.PI/180,a=n*(1+r);return{x:a*Math.sin(c)*Math.cos(s),y:a*Math.cos(c),z:a*Math.sin(c)*Math.sin(s)}},x=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,c=f(e,t,n,r);return new u.Vector3(c.x,c.y,c.z)},m=(new Date).getTimezoneOffset()||0,h=[0,Math.PI*(m/720),0],g=n(4),O=function(){return Object(g.jsxs)("mesh",{rotation:h,children:[Object(g.jsx)("sphereBufferGeometry",{args:[j,32,32]}),Object(g.jsx)("meshBasicMaterial",{color:"#1F2937"})]})},v=n(14),y=n.n(v),p=n(21),C=function(){var e=Object(r.useState)([]),t=Object(a.a)(e,2),n=t[0],c=t[1];return Object(r.useEffect)((function(){var e=function(){var e=Object(p.a)(y.a.mark((function e(){var t,n,r,s,a,i,o,l,u,j;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e,t){var n=new Image;n.addEventListener("load",(function(){return e(n)})),n.addEventListener("error",(function(e){return t(e)})),n.src="".concat("/globetravel","/images/map.png")}));case 2:t=e.sent,n=b(t),r=[],s=Math.PI/180,a=200,i=-90;case 8:if(!(i<=90)){e.next=23;break}o=25*Math.cos(Math.abs(i)*s)*Math.PI*2*2,l=0;case 11:if(!(l<o)){e.next=20;break}if(d(u=360*l/o-180,i,n)){e.next=15;break}return e.abrupt("continue",17);case 15:j=f(i,u),r.push(j.x,j.y,j.z);case 17:l++,e.next=11;break;case 20:i+=180/a,e.next=8;break;case 23:c(new Float32Array(r));case 24:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();e()}),[]),Object(g.jsxs)("points",{rotation:h,children:[Object(g.jsx)("bufferGeometry",{attach:"geometry",children:n.length&&Object(g.jsx)("bufferAttribute",{attachObject:["attributes","position"],count:n.length/3,array:n,itemSize:3})}),Object(g.jsx)("pointsMaterial",{size:1.5,color:"#C7D2FE"})]})},N=function(e){var t=e.city,n=t.lat,c=t.lng,s=Object(r.useMemo)((function(){var e=x(n,c,j),t=x(n,c,85);return new u.CatmullRomCurve3([e,t])}),[n,c]),a=Object(r.useMemo)((function(){var e=f(n,c,85);return[e.x,e.y,e.z]}),[n,c]);return Object(g.jsxs)("mesh",{rotation:h,children:[Object(g.jsxs)("mesh",{children:[Object(g.jsx)("tubeBufferGeometry",{args:[s,44,.3,8]}),Object(g.jsx)("meshBasicMaterial",{color:"#FCD34D"})]}),Object(g.jsxs)("mesh",{position:a,children:[Object(g.jsx)("sphereBufferGeometry",{args:[.3,5,5]}),Object(g.jsx)("meshBasicMaterial",{color:"#FCD34D"})]})]})},w=n(40),I={trail:"#10B981",sail:"#06B6D4",bus:"#F472B6",car:"#F59E0B"},k=function(e){var t=e.travel,n=Object(r.useMemo)((function(){for(var e=t.start,n=t.end,r=x(e.lat,e.lng,80.3),c=x(n.lat,n.lng,80.3),s=[r],a=Object(w.a)([e.lng,e.lat],[n.lng,n.lat]),i=1;i<6;i++){var o=a(1/7*i);s.push(x(o[1],o[0],80.3))}return s.push(c),new u.CatmullRomCurve3(s)}),[t]);return Object(g.jsxs)("mesh",{rotation:h,children:[Object(g.jsx)("tubeBufferGeometry",{args:[n,44,.3,8]}),Object(g.jsx)("meshBasicMaterial",{color:I[t.type]})]})},S=function(e){var t=e.travel,n=Object(r.useMemo)((function(){var e=t.start,n=t.end,r=x(e.lat,e.lng,j),c=x(n.lat,n.lng,j),s=Object(w.a)([e.lng,e.lat],[n.lng,n.lat]),a=s(.25),i=s(.75),o=.5*r.distanceTo(c)+j,l=x(a[1],a[0],o),d=x(i[1],i[0],o);return new u.CubicBezierCurve3(r,l,d,c)}),[t]);return Object(g.jsxs)("mesh",{rotation:h,children:[Object(g.jsx)("tubeBufferGeometry",{args:[n,44,.3,8]}),Object(g.jsx)("meshBasicMaterial",{color:"#EF4444"})]})},M=function(e){var t=e.cities,n=e.travels;return Object(g.jsxs)(o.a,{orthographic:!0,camera:{position:[0,0,200],zoom:3},children:[Object(g.jsx)(O,{}),Object(g.jsx)(C,{}),t.map((function(e){return Object(g.jsx)(N,{city:e},e.geonameId)})),n.map((function(e){return"flight"===e.type?Object(g.jsx)(S,{travel:e},e.id):Object(g.jsx)(k,{travel:e},e.id)})),Object(g.jsx)(l.a,{enablePan:!0,enableRotate:!0,autoRotate:!0})]})},F=n(12),B=n(9),T=n(77),R=n.n(T),E=n(78),D=n(46),z=n.n(D),A=n(79),G={ENG:"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f",SCT:"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f",WLS:"\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f"},P=Object.keys(G),J=function(e){return P.includes(e)?z()(G[e]):z()(Object(A.a)(e))},L=function(e){var t=e.onSelect,n=Object(r.useState)(""),c=Object(a.a)(n,2),s=c[0],i=c[1],o=Object(r.useState)([]),l=Object(a.a)(o,2),u=l[0],j=l[1],d=Object(r.useRef)();return Object(r.useEffect)((function(){return d.current.focus()}),[]),Object(r.useEffect)((function(){var e=function(){var e=Object(p.a)(y.a.mark((function e(){var t;return y.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,R.a.get("https://secure.geonames.org/search",{params:{username:"lexcast",maxRows:5,q:s,type:"json"}});case 3:t=e.sent,j(t.data.geonames.map((function(e){return"GB"===e.countryCode&&P.includes(e.adminCode1)?Object(B.a)(Object(B.a)({},e),{},{countryCode:e.adminCode1}):e}))),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),j([]),console.error(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();s?e():j([])}),[s]),Object(g.jsxs)("div",{className:"flex flex-col justify-center relative",children:[Object(g.jsx)(E.DebounceInput,{inputRef:d,minLength:2,value:s,debounceTimeout:300,placeholder:"Search any place...",className:"flex items-center h-10 px-3 rounded-full bg-gray-800 text-gray-300 focus:outline-none focus:ring",onChange:function(e){return i(e.target.value)}}),Array.isArray(u)&&u.length>0&&Object(g.jsx)("div",{className:"top-10 ring left-0 right-0 absolute mt-4 rounded-lg bg-gray-800 overflow-hidden text-sm",children:u.map((function(e){return Object(g.jsxs)("div",{onClick:function(){t(e),j([]),i(""),d.current.focus()},className:"cursor-pointer px-3 py-2 flex items-center hover:bg-gray-700",children:[e.countryCode&&Object(g.jsx)("span",{className:"mr-2",children:J(e.countryCode)}),Object(g.jsx)("span",{className:"flex-1",children:e.name}),e.adminName1&&Object(g.jsx)("span",{className:"ml-2 text-xs text-gray-400",children:e.adminName1})]},e.geonameId)}))})]})},W=n(16),_=n(15),U={flight:_.f,trail:_.i,sail:_.g,bus:_.c,car:_.d},V=function(e){var t=e.onFinish,n=Object(r.useState)(),c=Object(a.a)(n,2),s=c[0],i=c[1],o=Object(r.useState)(),l=Object(a.a)(o,2),u=l[0],j=l[1];return Object(g.jsxs)("div",{className:"flex flex-col justify-center",children:[!s&&Object(g.jsx)("div",{className:"flex items-center justify-around",children:Object.entries(U).map((function(e){var t=Object(a.a)(e,2),n=t[0],r=t[1];return Object(g.jsx)("div",{onClick:function(){return i(n)},className:"flex items-center justify-center rounded-full h-10 w-10 bg-gray-800 cursor-pointer hover:bg-gray-700",children:Object(g.jsx)(W.a,{icon:r})},n)}))}),!!s&&!u&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("div",{className:"flex items-center mb-2",children:[Object(g.jsx)("div",{className:"text-xs mr-2 flex items-center justify-center rounded-full h-6 w-6 bg-gray-800",children:Object(g.jsx)(W.a,{icon:U[s]})}),"From:"]}),Object(g.jsx)(L,{onSelect:function(e){return j(e)}})]}),!!s&&!!u&&Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("div",{className:"flex items-center mb-2",children:[Object(g.jsx)("div",{className:"mr-2 flex items-center justify-center rounded-full h-6 w-6 bg-gray-800",children:Object(g.jsx)(W.a,{icon:U[s]})}),Object(g.jsxs)("div",{className:"flex items-center mr-2",children:[u.countryCode&&Object(g.jsx)("span",{className:"mr-2",children:J(u.countryCode)}),Object(g.jsx)("span",{children:u.name})]}),"To:"]}),Object(g.jsx)(L,{onSelect:function(e){t(s,u,e),i(),j()}})]})]})},q={flight:_.f,trail:_.i,sail:_.g,bus:_.c,car:_.d},X=function(e){var t=e.travels,n=e.onRemove;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("span",{className:"text-xs font-medium mb-1 mt-2",children:["TRAVELS ",Object(g.jsxs)("span",{className:"text-gray-400",children:["(",t.length,")"]})]}),Object(g.jsx)("div",{className:"text-xs max-h-24 bg-gray-800 rounded-lg overflow-y-auto",children:t.map((function(e){return Object(g.jsxs)("div",{className:"group cursor-pointer px-3 py-2 flex items-center hover:bg-gray-700",children:[Object(g.jsx)(W.a,{className:"text-xs mr-2 text-gray-400",icon:q[e.type]}),Object(g.jsx)("div",{className:"flex-1 flex items-center",children:["start","end"].map((function(t){return Object(g.jsxs)("div",{className:"flex items-center",children:[e[t].countryCode&&Object(g.jsx)("span",{className:"mr-2 flex-shrink-0",children:J(e[t].countryCode)}),Object(g.jsx)("span",{className:"flex-1",children:e[t].name}),"start"===t&&Object(g.jsx)(W.a,{className:"text-xs mx-2 text-gray-500",icon:_.a})]},t)}))}),Object(g.jsx)("span",{onClick:function(){return n(e)},className:"group-hover:visible invisible text-xs",children:Object(g.jsx)(W.a,{icon:_.h})})]},e.id)}))})]})},$=function(e){var t=e.cities,n=e.onRemove;return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("span",{className:"text-xs font-medium mb-1 mt-2",children:["CITIES ",Object(g.jsxs)("span",{className:"text-gray-400",children:["(",t.length,")"]})]}),Object(g.jsx)("div",{className:"text-xs max-h-24 bg-gray-800 rounded-lg overflow-y-auto",children:t.map((function(e){return Object(g.jsxs)("div",{className:"group px-3 py-2 flex items-center hover:bg-gray-700",children:[e.countryCode&&Object(g.jsx)("span",{className:"mr-2 flex-shrink-0",children:J(e.countryCode)}),Object(g.jsx)("span",{className:"flex-1",children:e.name}),Object(g.jsx)("span",{onClick:function(){return n(e)},className:"cursor-pointer group-hover:visible invisible text-xs",children:Object(g.jsx)(W.a,{icon:_.h})})]},e.geonameId)}))})]})},H=function(e){var t=e.countries;return Object(g.jsx)("div",{className:"flex flex-wrap mb-6",children:t.map((function(e){return Object(g.jsx)("div",{children:J(e)},e)}))})},K=function(e){var t=e.cities,n=e.travels,r=e.countries;return Object(g.jsx)("a",{title:"Export",className:"flex items-center justify-center focus:outline-none focus:ring w-8 h-8 rounded bg-gray-800 hover:bg-gray-700",href:"data:text/json;charset=utf-8,".concat(encodeURIComponent(JSON.stringify({cities:t,travels:n,countries:r},null,2))),download:"globetravel.json",children:Object(g.jsx)(W.a,{icon:_.e})})},Q=function(e){var t=e.setCities,n=e.setTravels,r=e.setCountries;return Object(g.jsxs)("label",{title:"Import",className:"cursor-pointer flex items-center justify-center focus:outline-none focus:ring w-8 h-8 rounded bg-gray-800 hover:bg-gray-700",children:[Object(g.jsx)("input",{className:"hidden",type:"file",accept:"application/JSON",onChange:function(e){var c=new FileReader;c.readAsText(e.target.files[0],"UTF-8"),c.onload=function(e){var c=JSON.parse(e.target.result);t(c.cities),n(c.travels),r(c.countries)}}}),Object(g.jsx)(W.a,{icon:_.k})]})},Y=function(e){var t=e.setCities,n=e.setTravels,r=e.setCountries;return Object(g.jsx)("button",{onClick:function(){window.confirm("Do you really want to delete everything?")&&(t([]),n([]),r([]))},title:"Reset",className:"flex items-center justify-center focus:outline-none focus:ring w-8 h-8 rounded bg-gray-800 hover:bg-gray-700",children:Object(g.jsx)(W.a,{icon:_.j})})},Z=function(){return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("div",{className:"justify-end flex items-center mt-4 mb-1 text-gray-400 text-xs",children:["Made by",Object(g.jsx)("span",{className:"mx-1",children:J("MX")}),Object(g.jsx)("a",{target:"_blank",rel:"noopener noreferrer",className:"text-blue-400",href:"https://github.com/lexcast",children:"Daniel Alejandro Cast"})]}),Object(g.jsxs)("div",{className:"text-right text-gray-400 text-xs",children:["Globetravel uses"," ",Object(g.jsx)("a",{target:"_blank",rel:"noopener noreferrer",className:"text-blue-400",href:"https://www.geonames.org/",children:"Geonames API"})]})]})},ee=n(42),te=n.n(ee),ne=["geonameId","name","countryCode","adminName1","lat","lng"],re=function(e){var t=e.cities,n=e.setCities,c=e.travels,s=e.setTravels,i=e.countries,o=e.setCountries,l=Object(r.useState)(),u=Object(a.a)(l,2),j=u[0],d=u[1],b=Object(r.useState)(!1),f=Object(a.a)(b,2),x=f[0],m=f[1],h=function(e,t,n){return t.some((function(t){return t.countryCode===e}))||n.some((function(t){return t.start.countryCode===e||t.end.countryCode===e}))};return Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)("button",{onClick:function(){return m(!x)},className:"z-20 md:hidden absolute top-0 right-0 mt-4 mr-4 focus:outline-none focus:ring rounded-full bg-gray-800 h-8 w-8 flex items-center justify-center text-gray-300 hover:bg-gray-700 font-bolt",children:Object(g.jsx)(W.a,{icon:x?_.h:_.b})}),Object(g.jsxs)("div",{className:"bg-gray-900 absolute w-full md:relative flex-1 flex-col flex-nowrap px-10 pt-14 pb-4 h-screen overflow-y-auto "+(x?"flex":"hidden md:flex"),children:[i.length>0&&Object(g.jsx)(H,{countries:i}),Object(g.jsxs)("div",{className:"flex-1",children:[Object(g.jsxs)("div",{className:"flex justify-around mb-8",children:[Object(g.jsx)("button",{onClick:function(){return d("city"===j?null:"city")},className:"focus:outline-none focus:ring rounded-full bg-gray-800 h-8 px-4 flex items-center text-gray-300 hover:bg-gray-700 font-bolt",children:"Add City"}),Object(g.jsx)("button",{onClick:function(){return d("travel"===j?null:"travel")},className:"focus:outline-none focus:ring rounded-full bg-gray-800 h-8 px-4 flex items-center text-gray-300 hover:bg-gray-700 font-bolt",children:"Add Travel"})]}),"city"===j&&Object(g.jsx)(L,{onSelect:function(e){var r=te()(e,ne);n([].concat(Object(F.a)(t),[r])),i.includes(r.countryCode)||o([].concat(Object(F.a)(i),[r.countryCode]))}}),"travel"===j&&Object(g.jsx)(V,{onFinish:function(e,t,n){var r=te()(t,ne),a=te()(n,ne),l=t.geonameId+"_"+n.geonameId;s([].concat(Object(F.a)(c),[{type:e,start:r,end:a,id:l}])),i.includes(t.countryCode)||o((function(e){return[].concat(Object(F.a)(e),[t.countryCode])})),i.includes(n.countryCode)||o((function(e){return[].concat(Object(F.a)(e),[n.countryCode])}))}})]}),t.length>0&&Object(g.jsx)($,{cities:t,onRemove:function(e){var r=e.geonameId,s=e.countryCode,a=t.filter((function(e){return r!==e.geonameId}));n(a),h(s,a,c)||o(i.filter((function(e){return e!==s})))}}),c.length>0&&Object(g.jsx)(X,{travels:c,onRemove:function(e){var n=e.id,r=e.start,a=e.end,i=c.filter((function(e){return n!==e.id}));s(i),h(r.countryCode,t,i)||o((function(e){return e.filter((function(e){return e!==r.countryCode}))})),h(a.countryCode,t,i)||o((function(e){return e.filter((function(e){return e!==a.countryCode}))}))}}),Object(g.jsxs)("div",{className:"mt-6 flex items-center justify-end gap-4",children:[Object(g.jsx)(Y,{setCities:n,setTravels:s,setCountries:o}),Object(g.jsx)(Q,{setCities:n,setTravels:s,setCountries:o}),Object(g.jsx)(K,{cities:t,travels:c,countries:i})]}),Object(g.jsx)(Z,{})]})]})},ce=function(){var e=i("@globetravel.cities",[]),t=Object(a.a)(e,2),n=t[0],r=t[1],c=i("@globetravel.travels",[]),s=Object(a.a)(c,2),o=s[0],l=s[1],u=i("@globetravel.countries",[]),j=Object(a.a)(u,2),d=j[0],b=j[1];return Object(g.jsxs)("div",{className:"text-gray-300 w-screen h-screen bg-gray-900 flex overflow-hidden flex-no-wrap",children:[Object(g.jsx)("div",{className:"h-screen w-full md:w-2/3 bg-gray-900",children:Object(g.jsx)(M,{cities:n,travels:o})}),Object(g.jsx)(re,{cities:n,setCities:r,travels:o,setTravels:l,countries:d,setCountries:b})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(g.jsx)(ce,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[153,1,2]]]);
//# sourceMappingURL=main.a9fbe47f.chunk.js.map